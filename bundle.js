(()=>{"use strict";class t{#t;constructor(t,i,e,s,h,r,n,a,o){this.#t=[t,i,e,s,h,r,n,a,o]}set(t,i,e,s,h,r,n,a,o){return this.#t[0]=t,this.#t[1]=i,this.#t[2]=e,this.#t[3]=s,this.#t[4]=h,this.#t[5]=r,this.#t[6]=n,this.#t[7]=a,this.#t[8]=o,this}copy(){return new t(...this.#t)}multiply(t){const i=this.#t,e=t.#t,s=[0,0,0,0,0,0,0,0,0];return s[0]=i[0]*e[0]+i[1]*e[3]+i[2]*e[6],s[1]=i[0]*e[1]+i[1]*e[4]+i[2]*e[7],s[2]=i[0]*e[2]+i[1]*e[5]+i[2]*e[8],s[3]=i[3]*e[0]+i[4]*e[3]+i[5]*e[6],s[4]=i[3]*e[1]+i[4]*e[4]+i[5]*e[7],s[5]=i[3]*e[2]+i[4]*e[5]+i[5]*e[8],s[6]=i[6]*e[0]+i[7]*e[3]+i[8]*e[6],s[7]=i[6]*e[1]+i[7]*e[4]+i[8]*e[7],s[8]=i[6]*e[2]+i[7]*e[5]+i[8]*e[8],this.#t=s,this}get data(){return this.#t}static identity(){return new t(1,0,0,0,1,0,0,0,1)}static translation(i,e){return new t(1,0,i,0,1,e,0,0,1)}static rotation(i){const e=Math.cos(i),s=Math.sin(i);return new t(e,-s,0,s,e,0,0,0,1)}static scale(i,e){return new t(i,0,0,0,e,0,0,0,1)}}class i{#i=0;#e=0;#s=0;#h=0;constructor(t,i){this.x=t,this.y=i}set(t){return this.x=t.x,this.y=t.y,this}copy({x:t=this.x,y:e=this.y}={}){return new i(t,e)}add(t){return this.x+=t.x,this.y+=t.y,this}subtract(t){return this.x-=t.x,this.y-=t.y,this}multiply(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t,this.y/=t,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}transform(t){const{x:i,y:e}=this,s=t.data;return this.x=i*s[0]+e*s[1]+1*s[2],this.y=i*s[3]+e*s[4]+1*s[5],this}translate(i){return this.transform(t.translation(i.x,i.y))}rotate(i){return this.transform(t.rotation(i))}scale(i){return this.transform(t.scale(i.x,i.y))}normalize(){const t=this.magnitude;return 0!==t&&this.divide(t),this}set x(t){this.#i=t,this.#s=Math.atan2(this.#e,t),this.#h=Math.sqrt(t**2+this.#e**2)}get x(){return this.#i}set y(t){this.#e=t,this.#s=Math.atan2(t,this.#i),this.#h=Math.sqrt(this.#i**2+t**2)}get y(){return this.#e}set theta(t){this.#s=t,this.#i=this.#h*Math.cos(t),this.#e=this.#h*Math.sin(t)}get theta(){return this.#s}set magnitude(t){this.#h=t,this.#i=t*Math.cos(this.#s),this.#e=t*Math.sin(this.#s)}get magnitude(){return this.#h}set r(t){this.magnitude=t}get r(){return this.magnitude}static add(t,e){return new i(t.x,t.y).add(e)}static subtract(t,e){return new i(t.x,t.y).subtract(e)}static multiply(t,e){return new i(t.x,t.y).multiply(e)}static divide(t,e){return new i(t.x,t.y).divide(e)}static dot(t,e){return new i(t.x,t.y).dot(e)}static cross(t,e){return new i(t.x,t.y).cross(e)}static transform(t,e){return new i(t.x,t.y).transform(e)}static translate(t,e){return new i(t.x,t.y).translate(e)}static rotate(t,e){return new i(t.x,t.y).rotate(e)}static scale(t,e){return new i(t.x,t.y).scale(e)}static normalize(t){return new i(t.x,t.y).normalize()}static fromPolar(t,e){return new i(e*Math.cos(t),e*Math.sin(t))}}class e{#r;#n;#a;#o;#l;#c;constructor(t,e){this.#a=Math.abs(e.x-t.x),this.#o=Math.abs(e.y-t.y),this.#l=this.#a/2,this.#c=this.#o/2,this.#r=new i(this.#l+t.x,this.#c+t.y),this.#n=this.#r.copy()}reset(){this.#n=this.#r.copy()}move(t){this.#n.add(t)}collide(t){return t.left<this.right&&t.right>this.left&&t.top<this.bottom&&t.bottom>this.top}get position(){return this.#n}get topLeft(){return i.subtract(this.#n,{x:this.#l,y:this.#c})}get bottomRight(){return i.add(this.#n,{x:this.#l,y:this.#c})}get top(){return this.#n.y-this.#c}get bottom(){return this.#n.y+this.#c}get left(){return this.#n.x-this.#l}get right(){return this.#n.x+this.#l}get x(){return this.#n.x}get y(){return this.#n.y}get width(){return this.#a}get height(){return this.#o}}class s extends e{#d;#x=0;#u=0;constructor(t,i=20){const e=.5*i;super({x:t.x-e,y:t.y-e},{x:t.x+e,y:t.y+e}),this.#d=i}reset(){super.reset(),this.#x=0,this.#u=0}jump(){this.#x=s.#g}update(){this.#x=Math.max(Math.min(this.#x+s.#y,s.#p),s.#g);const t={x:0,y:this.#x};this.move(t)}incrementScore(){this.#u++}get size(){return this.#d}get score(){return this.#u}static#p=40;static#g=-8;static#y=.5}class h{#n;#f;#m;constructor(t,s){s=Math.min(h.#b-h.#w/2-h.#P,Math.max(h.#S+h.#w/2+h.#P,s)),this.#n=new i(t,s);const r=.5*h.#v,n=.5*h.#w;this.#f=new e({x:t-r,y:h.#S},{x:t+r,y:s-n}),this.#m=new e({x:t-r,y:s+n},{x:t+r,y:h.#b})}update(t,e){const s=i.multiply({x:-2,y:0},t*e);this.#f.move(s),this.#m.move(s),this.#n.add(s)}nextIfThereIsSpaceTo(t){const i=this.#O();return i.x<t+h.#v/2?new h(i.x,i.y):null}#O(){const t=this.#n.x+h.#v+h.#A,i=100*Math.random()+100,e=this.#n.y-i<h.#S+h.#w/2+h.#P,s=this.#n.y+i>h.#b-h.#w/2-h.#P;let r=this.#n.y;return e?r+=i:s?r-=i:r+=i*Math.sign(Math.random()-.5),{x:t,y:r}}get left(){return this.#n.x-h.#v/2}get right(){return this.#n.x+h.#v/2}get top(){return this.#f}get bottom(){return this.#m}static#w=150;static#v=50;static#A=300;static#S=0;static#b=0;static#P=20;static set TOP_BOUNDARY(t){h.#S=t}static set BOTTOM_BOUNDARY(t){h.#b=t}static get SIZE(){return h.#v}}class r{#T;#D;#I=0;#E=[];#M=!1;#k;#B=!1;#f;#m;#N;#R;constructor(t){this.#f=20,this.#m=t.height-20,this.#N=new e({x:0,y:0},{x:t.width,y:this.#f}),this.#R=new e({x:0,y:this.#m},{x:t.width,y:t.height}),h.TOP_BOUNDARY=this.#f,h.BOTTOM_BOUNDARY=this.#m,this.#k=r.#_,this.#T=t,this.#D=new s(t.center.copy({x:100})),this.#E=this.#Y(),window.addEventListener("keydown",(t=>{" "!==t.key&&"ArrowUp"!==t.key||this.#D.jump()})),window.addEventListener("click",(()=>this.#D.jump())),this.load()}#Y(){const t=[];let i=new h(this.#T.center.x,this.#T.center.y);for(t.push(i);;){const e=i.nextIfThereIsSpaceTo(this.#T.width);if(null===e)break;t.push(e),i=e}return t}reset(){this.save(),this.#D.score>this.#I&&(this.#I=this.#D.score),this.#D.reset(),this.#M=!1,this.#E=this.#Y(),this.#k=r.#_}save(){localStorage.setItem(r.#W,this.#I.toString())}load(){this.#I=+(localStorage.getItem(r.#W)??0)}update(t){this.#k+=.001,this.#D.update();for(const i of this.#E)i.update(t,this.#k);this.#E[0].right<0&&this.#E.shift();const i=this.#E.at(-1);if(i){const t=i.nextIfThereIsSpaceTo(this.#T.width);t&&this.#E.push(t)}(this.#N.collide(this.#D)||this.#R.collide(this.#D))&&(this.#M=!0);const e=this.#G();e&&(e===this.#E[1]?this.#B||(this.#D.incrementScore(),this.#B=!0):this.#B=!1,this.#L(e)&&(this.#M=!0)),this.#M&&this.reset()}#L({top:t,bottom:i}){return t.collide(this.#D)||i.collide(this.#D)}#G(){return[this.#E[0],this.#E[1]].find((t=>t.right>this.#D.left))}render(){this.#T.beginPath().rect(this.#N.topLeft,this.#N.width,this.#N.height).rect(this.#R.topLeft,this.#R.width,this.#R.height).closePath().fill("#0f0").stroke({color:"#000",width:2});for(const{top:t,bottom:i}of this.#E)this.#T.beginPath().rect(t.topLeft,t.width,t.height).rect(i.topLeft,i.width,i.height).closePath().fill("#0f0").stroke({color:"black",width:2});this.#T.beginPath().circle(this.#D.position,this.#D.size/2).closePath().fill("#ff0").stroke({color:"black",width:2}),this.#T.text({text:`Best score: ${this.#I}`,at:this.#T.center.copy().subtract({x:0,y:130}),fillStyle:"#fff",strokeStyle:"transparent"}).text({text:this.#D.score.toString(),at:this.#T.center.copy().subtract({x:0,y:100}),size:36,fillStyle:"#fff",strokeStyle:"#fff"})}get bird(){return this.#D}get isOver(){return this.#M}static#_=1;static#W="highscore"}const n=new class{#H;#T;#U;#z=new i(0,0);#C="#fff";#Z="#fff";#V=1;#q=[];#j=0;#F="start";#K="alphabetic";#X="10px sans-serif";#$=1;#J=1;constructor(t,i,e){this.#H=t,this.#T=document.getElementById(t),this.#U=this.#T.getContext("2d"),this.fillStyle="#fff",this.strokeStyle="#fff",this.lineWidth=1,this.lineDash=[],this.lineDashOffset=0,this.textAlign="start",this.textBaseline="alphabetic",this.font="10px sans-serif",this.globalAlpha=1,this.resize(i,e)}resize(t,e){return this.#T.width=t,this.#T.height=e,this.#J=t/e,this.#z=new i(+(t/2).toFixed(4),+(e/2).toFixed(4)),this}drawImage(t,i,e,s){return this.context.drawImage(t,i.x,i.y,e,s),this}rotateAndDrawImage(t,i,e,s,h){return this.save().translate(i).rotate(-h).drawImage(t,{x:-e/2,y:-s/2},e,s).restore(),this}circle(t,i){return this.context.arc(t.x,t.y,i,0,2*Math.PI),this}rect(t,i,e){return this.context.rect(t.x,t.y,i,e),this}line(t,i){return this.context.moveTo(t.x,t.y),this.context.lineTo(i.x,i.y),this}moveTo(t){return this.context.moveTo(t.x,t.y),this}lineTo(t){return this.context.lineTo(t.x,t.y),this}text({text:t,at:i,fillStyle:e=this.#C,strokeStyle:s=this.#Z,size:h=16}){return this.beginPath(),this.textAlign="center",this.textBaseline="middle",this.fillStyle=e,this.strokeStyle=s,this.font=`${h}px Arial`,this.context.fillText(t,i.x,i.y),this.context.strokeText(t,i.x,i.y),this}beginPath(){return this.context.beginPath(),this}closePath(){return this.context.closePath(),this}stroke({color:t=this.#Z,width:i=this.#V,dash:e=this.#q}={}){return this.strokeStyle=t,this.lineWidth=i,this.lineDash=e,this.context.stroke(),this}fill(t=this.#C){return this.fillStyle=t,this.context.fill(),this}background(t="#000"){return this.#T.style.backgroundColor=t,this}clear(){return this.context.clearRect(0,0,this.width,this.height),this}translate(t){return this.context.translate(t.x,t.y),this}rotate(t){return this.context.rotate(t),this}save(){return this.context.save(),this}restore(){return this.context.restore(),this}requestPointerLock(){return this.#T.requestPointerLock(),this}set fillStyle(t){this.#C=t,this.context.fillStyle=t}set strokeStyle(t){this.#Z=t,this.context.strokeStyle=t}set lineWidth(t){this.#V=t,this.context.lineWidth=t}set lineDash(t){this.#q=t,this.context.setLineDash(Array.from(t))}set lineDashOffset(t){this.#j=t,this.context.lineDashOffset=t}set textAlign(t){this.#F=t,this.context.textAlign=t}set textBaseline(t){this.#K=t,this.context.textBaseline=t}set font(t){this.#X=t,this.context.font=t}set globalAlpha(t){this.#$=t,this.context.globalAlpha=t}get id(){return this.#H}get canvas(){return this.#T}get context(){if(!this.#U)throw new Error("CanvasRenderingContext2D is null");return this.#U}get center(){return this.#z}get width(){return this.#T.width}get height(){return this.#T.height}get aspectRatio(){return this.#J}get fillStyle(){return this.#C}get strokeStyle(){return this.#Z}get lineWidth(){return this.#V}get lineDash(){return this.#q}get lineDashOffset(){return this.#j}get textAlign(){return this.#F}get textBaseline(){return this.#K}get font(){return this.#X}get globalAlpha(){return this.#$}}("canvas",innerWidth,innerHeight);n.background("skyblue");const a=new r(n);let o=0;!function t(i){const e=(i-o)/15;o=i,a.update(e),n.clear(),a.render(),requestAnimationFrame(t)}(0),addEventListener("resize",(()=>{n.resize(innerWidth,innerHeight),a.render()}))})();