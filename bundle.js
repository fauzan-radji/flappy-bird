(()=>{"use strict";class t{#t;constructor(t,e,i,s,r,h,n,a,o){this.#t=[t,e,i,s,r,h,n,a,o]}set(t,e,i,s,r,h,n,a,o){return this.#t[0]=t,this.#t[1]=e,this.#t[2]=i,this.#t[3]=s,this.#t[4]=r,this.#t[5]=h,this.#t[6]=n,this.#t[7]=a,this.#t[8]=o,this}copy(){return new t(...this.#t)}multiply(t){const e=this.#t,i=t.#t,s=[0,0,0,0,0,0,0,0,0];return s[0]=e[0]*i[0]+e[1]*i[3]+e[2]*i[6],s[1]=e[0]*i[1]+e[1]*i[4]+e[2]*i[7],s[2]=e[0]*i[2]+e[1]*i[5]+e[2]*i[8],s[3]=e[3]*i[0]+e[4]*i[3]+e[5]*i[6],s[4]=e[3]*i[1]+e[4]*i[4]+e[5]*i[7],s[5]=e[3]*i[2]+e[4]*i[5]+e[5]*i[8],s[6]=e[6]*i[0]+e[7]*i[3]+e[8]*i[6],s[7]=e[6]*i[1]+e[7]*i[4]+e[8]*i[7],s[8]=e[6]*i[2]+e[7]*i[5]+e[8]*i[8],this.#t=s,this}get data(){return this.#t}static identity(){return new t(1,0,0,0,1,0,0,0,1)}static translation(e,i){return new t(1,0,e,0,1,i,0,0,1)}static rotation(e){const i=Math.cos(e),s=Math.sin(e);return new t(i,-s,0,s,i,0,0,0,1)}static scale(e,i){return new t(e,0,0,0,i,0,0,0,1)}}class e{#e=0;#i=0;#s=0;#r=0;constructor(t,e){this.x=t,this.y=e}set(t){return this.x=t.x,this.y=t.y,this}copy({x:t=this.x,y:i=this.y}={}){return new e(t,i)}add(t){return this.x+=t.x,this.y+=t.y,this}subtract(t){return this.x-=t.x,this.y-=t.y,this}multiply(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t,this.y/=t,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}transform(t){const{x:e,y:i}=this,s=t.data;return this.x=e*s[0]+i*s[1]+1*s[2],this.y=e*s[3]+i*s[4]+1*s[5],this}translate(e){return this.transform(t.translation(e.x,e.y))}rotate(e){return this.transform(t.rotation(e))}scale(e){return this.transform(t.scale(e.x,e.y))}normalize(){const t=this.magnitude;return 0!==t&&this.divide(t),this}set x(t){this.#e=t,this.#s=Math.atan2(this.#i,t),this.#r=Math.sqrt(t**2+this.#i**2)}get x(){return this.#e}set y(t){this.#i=t,this.#s=Math.atan2(t,this.#e),this.#r=Math.sqrt(this.#e**2+t**2)}get y(){return this.#i}set theta(t){this.#s=t,this.#e=this.#r*Math.cos(t),this.#i=this.#r*Math.sin(t)}get theta(){return this.#s}set magnitude(t){this.#r=t,this.#e=t*Math.cos(this.#s),this.#i=t*Math.sin(this.#s)}get magnitude(){return this.#r}set r(t){this.magnitude=t}get r(){return this.magnitude}static add(t,i){return new e(t.x,t.y).add(i)}static subtract(t,i){return new e(t.x,t.y).subtract(i)}static multiply(t,i){return new e(t.x,t.y).multiply(i)}static divide(t,i){return new e(t.x,t.y).divide(i)}static dot(t,i){return new e(t.x,t.y).dot(i)}static cross(t,i){return new e(t.x,t.y).cross(i)}static transform(t,i){return new e(t.x,t.y).transform(i)}static translate(t,i){return new e(t.x,t.y).translate(i)}static rotate(t,i){return new e(t.x,t.y).rotate(i)}static scale(t,i){return new e(t.x,t.y).scale(i)}static normalize(t){return new e(t.x,t.y).normalize()}static fromPolar(t,i){return new e(i*Math.cos(t),i*Math.sin(t))}}class i{#h;#n;#a;#o=0;#c=0;constructor(t,e=20){this.#h=t,this.#n=t.copy(),this.#a=e}reset(){this.#n.set(this.#h),this.#o=0,this.#c=0}jump(){this.#o=i.#l}update(){this.#o=Math.max(Math.min(this.#o+i.#u,i.#d),i.#l),this.#n.add({x:0,y:this.#o})}incrementScore(){this.#c++}get position(){return this.#n}get size(){return this.#a}get left(){return this.#n.x-this.#a/2}get right(){return this.#n.x+this.#a/2}get top(){return this.#n.y-this.#a/2}get bottom(){return this.#n.y+this.#a/2}get score(){return this.#c}static#d=40;static#l=-8;static#u=.5}class s{#n;constructor(t,i){i=Math.min(s.#x-s.#p/2-s.#y,Math.max(s.#g+s.#p/2+s.#y,i)),this.#n=new e(t,i)}update(t,i){this.#n.subtract(e.multiply({x:2,y:0},t*i))}nextIfThereIsSpaceTo(t){const e=this.#f();return e.x<t+s.#m/2?new s(e.x,e.y):null}#f(){const t=this.#n.x+s.#m+s.#P,e=100*Math.random()+100,i=this.#n.y-e<s.#g+s.#p/2+s.#y,r=this.#n.y+e>s.#x-s.#p/2-s.#y;let h=this.#n.y;return i?h+=e:r?h-=e:h+=e*Math.sign(Math.random()-.5),{x:t,y:h}}get left(){return this.#n.x-s.#m/2}get right(){return this.#n.x+s.#m/2}get bottomOfTopPart(){return this.#n.y-s.#p/2}get topOfBottomPart(){return this.#n.y+s.#p/2}get position(){return this.#n}static#p=150;static#m=50;static#P=300;static#g=0;static#x=0;static#y=20;static set TOP_BOUNDARY(t){s.#g=t}static set BOTTOM_BOUNDARY(t){s.#x=t}static get SIZE(){return s.#m}}class r{#S;#O;#b=0;#v=[];#A=!1;#T;#w=!1;constructor(t){s.TOP_BOUNDARY=0,s.BOTTOM_BOUNDARY=t.height,this.#T=r.#D,this.#S=t,this.#O=new i(t.center.copy({x:100})),this.#v=this.#I(),window.addEventListener("keydown",(t=>{" "!==t.key&&"ArrowUp"!==t.key||this.#O.jump()})),window.addEventListener("click",(()=>this.#O.jump())),this.load()}#I(){const t=[];let e=new s(this.#S.center.x,this.#S.center.y);for(t.push(e);;){const i=e.nextIfThereIsSpaceTo(this.#S.width);if(null===i)break;t.push(i),e=i}return t}reset(){this.save(),this.#O.score>this.#b&&(this.#b=this.#O.score),this.#O.reset(),this.#A=!1,this.#v=this.#I(),this.#T=r.#D}save(){localStorage.setItem(r.#E,this.#b.toString())}load(){this.#b=+(localStorage.getItem(r.#E)??0)}update(t){this.#T+=1e-4,this.#O.update();for(const e of this.#v)e.update(t,this.#T);this.#v[0].right<0&&this.#v.shift();const e=this.#v.at(-1);if(e){const t=e.nextIfThereIsSpaceTo(this.#S.width);t&&this.#v.push(t)}(this.#O.bottom>=this.#S.height||this.#O.top<=0)&&(this.#A=!0);const i=this.#B();i&&(i===this.#v[1]?this.#w||(this.#O.incrementScore(),this.#w=!0):this.#w=!1,this.#k(i)&&(this.#A=!0)),this.#A&&this.reset()}#k(t){return this.#O.right>=t.left&&this.#O.left<=t.right&&(this.#O.top<=t.bottomOfTopPart||this.#O.bottom>=t.topOfBottomPart)}#B(){return[this.#v[0],this.#v[1]].find((t=>t.right>this.#O.left))}render(){this.#S.beginPath().circle(this.bird.position,this.bird.size/2).closePath().fill("#ff0").stroke({color:"black",width:2});for(const t of this.#v)this.#S.beginPath().rect({x:t.left,y:0},s.SIZE,t.bottomOfTopPart).rect({x:t.left,y:t.topOfBottomPart},s.SIZE,this.#S.height-t.topOfBottomPart).closePath().fill("#0f0").stroke({color:"black",width:2});this.#S.text({text:`Best score: ${this.#b}`,at:this.#S.center.copy().subtract({x:0,y:130}),fillStyle:"#fff",strokeStyle:"transparent"}).text({text:this.#O.score.toString(),at:this.#S.center.copy().subtract({x:0,y:100}),size:36,fillStyle:"#fff",strokeStyle:"#fff"})}get bird(){return this.#O}get isOver(){return this.#A}static#D=1;static#E="highscore"}const h=new class{#M;#S;#N;#_=new e(0,0);#R="#fff";#Y="#fff";#G=1;#z=[];#U=0;#W="start";#C="alphabetic";#L="10px sans-serif";#Z=1;#H=1;constructor(t,e,i){this.#M=t,this.#S=document.getElementById(t),this.#N=this.#S.getContext("2d"),this.fillStyle="#fff",this.strokeStyle="#fff",this.lineWidth=1,this.lineDash=[],this.lineDashOffset=0,this.textAlign="start",this.textBaseline="alphabetic",this.font="10px sans-serif",this.globalAlpha=1,this.resize(e,i)}resize(t,i){return this.#S.width=t,this.#S.height=i,this.#H=t/i,this.#_=new e(+(t/2).toFixed(4),+(i/2).toFixed(4)),this}drawImage(t,e,i,s){return this.context.drawImage(t,e.x,e.y,i,s),this}rotateAndDrawImage(t,e,i,s,r){return this.save().translate(e).rotate(-r).drawImage(t,{x:-i/2,y:-s/2},i,s).restore(),this}circle(t,e){return this.context.arc(t.x,t.y,e,0,2*Math.PI),this}rect(t,e,i){return this.context.rect(t.x,t.y,e,i),this}line(t,e){return this.context.moveTo(t.x,t.y),this.context.lineTo(e.x,e.y),this}moveTo(t){return this.context.moveTo(t.x,t.y),this}lineTo(t){return this.context.lineTo(t.x,t.y),this}text({text:t,at:e,fillStyle:i=this.#R,strokeStyle:s=this.#Y,size:r=16}){return this.beginPath(),this.textAlign="center",this.textBaseline="middle",this.fillStyle=i,this.strokeStyle=s,this.font=`${r}px Arial`,this.context.fillText(t,e.x,e.y),this.context.strokeText(t,e.x,e.y),this}beginPath(){return this.context.beginPath(),this}closePath(){return this.context.closePath(),this}stroke({color:t=this.#Y,width:e=this.#G,dash:i=this.#z}={}){return this.strokeStyle=t,this.lineWidth=e,this.lineDash=i,this.context.stroke(),this}fill(t=this.#R){return this.fillStyle=t,this.context.fill(),this}background(t="#000"){return this.#S.style.backgroundColor=t,this}clear(){return this.context.clearRect(0,0,this.width,this.height),this}translate(t){return this.context.translate(t.x,t.y),this}rotate(t){return this.context.rotate(t),this}save(){return this.context.save(),this}restore(){return this.context.restore(),this}requestPointerLock(){return this.#S.requestPointerLock(),this}set fillStyle(t){this.#R=t,this.context.fillStyle=t}set strokeStyle(t){this.#Y=t,this.context.strokeStyle=t}set lineWidth(t){this.#G=t,this.context.lineWidth=t}set lineDash(t){this.#z=t,this.context.setLineDash(Array.from(t))}set lineDashOffset(t){this.#U=t,this.context.lineDashOffset=t}set textAlign(t){this.#W=t,this.context.textAlign=t}set textBaseline(t){this.#C=t,this.context.textBaseline=t}set font(t){this.#L=t,this.context.font=t}set globalAlpha(t){this.#Z=t,this.context.globalAlpha=t}get id(){return this.#M}get canvas(){return this.#S}get context(){if(!this.#N)throw new Error("CanvasRenderingContext2D is null");return this.#N}get center(){return this.#_}get width(){return this.#S.width}get height(){return this.#S.height}get aspectRatio(){return this.#H}get fillStyle(){return this.#R}get strokeStyle(){return this.#Y}get lineWidth(){return this.#G}get lineDash(){return this.#z}get lineDashOffset(){return this.#U}get textAlign(){return this.#W}get textBaseline(){return this.#C}get font(){return this.#L}get globalAlpha(){return this.#Z}}("canvas",innerWidth,innerHeight);h.background("skyblue");const n=new r(h);let a=0;!function t(e){const i=(e-a)/15;a=e,n.update(i),h.clear(),n.render(),requestAnimationFrame(t)}(0),addEventListener("resize",(()=>{h.resize(innerWidth,innerHeight),n.render()}))})();